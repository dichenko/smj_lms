# Техническое задание: LMS на основе Telegram-бота

## Описание проекта

Минимальная LMS для контроля прохождения курсов учениками через Telegram-бота.  
Вся проверка домашних заданий (отчетов) происходит вручную администратором через веб-интерфейс.  
Файлы отчетов НЕ хранятся на сервере — бот пересылает их админу в Telegram.

---

## Архитектура

- **Cloudflare Workers** — backend (API, обработка Telegram webhook)
- **Cloudflare D1** — хранение структуры курсов, уроков, статусов сдачи
- **React frontend** (Cloudflare Pages) — админ-панель
- **Telegram Bot API** — бот для учеников

---

## Пользовательские роли

- **Администратор:** через веб-интерфейс управляет курсами, уроками, учениками, проверяет и апрувит отчеты.
- **Ученик:** взаимодействует только через Telegram-бота.

---

## Функциональные требования

### 1. Telegram-бот (интерфейс ученика)
- Вход по TGID (авторизация по базе)
- Просмотр текущего активного урока ("N из M")
- Кнопка "Сдать отчет" — загрузка документа (отчет)
- Просмотр истории сданных уроков и их статуса
- Получение уведомления о принятии/отклонении отчета
- Получение уведомлений о появлении нового урока

### 2. Веб-интерфейс (админка)
- Вход по логину/паролю
- Просмотр/добавление/удаление учеников (TGID, имя)
- Назначение ученика на курс
- Просмотр/создание/редактирование курсов и уроков
- Отображение всех отчетов по курсу и ученикам
- Проверка отчета: "принять" или "отправить на доработку" (комментарий)
- История сдачи по каждому ученику/курсу/уроку
- Просмотр статусов сдачи по всем курсам и ученикам
- Просмотр логов ошибок (или отправка в Telegram админу)

### 3. Хранение файлов
- Все отчеты (файлы) НЕ хранятся на сервере, а моментально пересылаются боту админу в Telegram с подписью (имя ученика, курс, урок, дата).

---

## Структура базы данных (Cloudflare D1)

```sql
students (
    id INTEGER PRIMARY KEY,
    tg_id TEXT UNIQUE,
    name TEXT,
    course_id INTEGER,
    active_lesson INTEGER
)

courses (
    id INTEGER PRIMARY KEY,
    title TEXT
)

lessons (
    id INTEGER PRIMARY KEY,
    course_id INTEGER,
    "order" INTEGER,
    title TEXT,
    description TEXT,
    links TEXT -- JSON array
)

reports (
    id INTEGER PRIMARY KEY,
    student_id INTEGER,
    lesson_id INTEGER,
    submitted_at DATETIME,
    status TEXT,          -- 'pending', 'approved', 'rejected'
    admin_comment TEXT,
    telegram_file_id TEXT,
    checked_at DATETIME
)
